{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/stores/agentStore.ts"],"sourcesContent":["\nimport { create } from \"zustand\";\nimport { mockApi } from \"@/lib/mock-api\";\nimport type { AccessKey, Agent, AgentSettings, AgentStatus, ChatMessage, ChatSession, Customer, FileChatMessage, TextChatMessage } from \"@/lib/types\";\n\ninterface AgentState {\n  agent: Agent | null;\n  sessions: ChatSession[];\n  customers: Customer[];\n  settings: AgentSettings | null;\n  activeSessionId: string | null;\n  isLoading: boolean;\n  isExtendingKey: boolean;\n  error: string | null;\n  key: AccessKey | null;\n  shouldInvalidateAliases: boolean;\n\n\n  fetchAgentData: (agentId: string) => Promise<void>;\n  setActiveSessionId: (sessionId: string | null) => void;\n  sendMessage: (sessionId: string, message: Omit<TextChatMessage | FileChatMessage, 'id' | 'timestamp' | 'sender' | 'agentId'>) => Promise<void>;\n  updateStatus: (agentId: string, status: AgentStatus) => Promise<void>;\n  updateProfile: (agentId: string, updates: { name?: string; avatar?: string }) => Promise<void>;\n  updateSettings: (agentId: string, settings: AgentSettings) => Promise<void>;\n  pollSessionUpdates: (sessionId: string) => Promise<void>;\n  extendKey: (agentId: string, newKeyString: string) => Promise<boolean>;\n  blockCustomer: (ipAddress: string) => void;\n  unblockCustomer: (ipAddress: string) => void;\n  deleteCustomer: (customerId: string) => void;\n  archiveSession: (sessionId: string) => Promise<void>;\n  unarchiveSession: (sessionId: string) => Promise<void>;\n  sendFileMessage: (sessionId: string, file: File) => Promise<void>;\n  invalidateAliases: () => void;\n  aliasesInvalidated: () => void;\n}\n\n// Helper to fetch and update a single session\nasync function _fetchSession(sessionId: string, set: (fn: (state: AgentState) => Partial<AgentState>) => void) {\n    const updatedSession = await mockApi.getSessionUpdates(sessionId);\n    if (updatedSession) {\n        set(state => ({\n            sessions: state.sessions.map(s => s.id === sessionId ? updatedSession : s),\n        }));\n    }\n}\n\n\nexport const useAgentStore = create<AgentState>((set, get) => ({\n  agent: null,\n  sessions: [],\n  customers: [],\n  settings: null,\n  activeSessionId: null,\n  isLoading: false,\n  isExtendingKey: false,\n  error: null,\n  key: null,\n  shouldInvalidateAliases: false,\n\n\n  fetchAgentData: async (agentId) => {\n    set({ isLoading: true });\n    try {\n      const data = await mockApi.getAgentData(agentId);\n      if (data) {\n        set({\n          agent: data.agent,\n          sessions: data.sessions,\n          customers: data.customers,\n          settings: data.settings,\n          key: data.key,\n          isLoading: false,\n          activeSessionId: data.sessions.find(s => s.status === 'active')?.id || data.sessions.find(s => s.status === 'pending')?.id || null,\n        });\n      }\n    } catch (e) {\n      set({ error: e instanceof Error ? e.message : \"Failed to fetch agent data\", isLoading: false });\n    }\n  },\n  setActiveSessionId: (sessionId) => {\n    const customerId = get().sessions.find(s => s.id === sessionId)?.customerId;\n    if (customerId) {\n        const isBlocked = get().settings?.blockedIps.includes(get().customers.find(c => c.id === customerId)?.ipAddress || \"\");\n        if (isBlocked) {\n             set({ activeSessionId: sessionId, error: \"This customer is blocked.\" });\n             return;\n        }\n    }\n    set({ activeSessionId: sessionId, error: null });\n  },\n  sendMessage: async (sessionId, messageData) => {\n    const message: ChatMessage = {\n        id: '', // will be set by mock api\n        ...messageData,\n        sender: 'agent',\n        timestamp: new Date().toISOString(),\n        agentId: get().agent?.id,\n    }\n    // Send the message via API\n    await mockApi.sendMessage(sessionId, message);\n    // Fetch the updated session from the single source of truth (the API)\n    await _fetchSession(sessionId, set);\n  },\n  updateStatus: async (agentId, status) => {\n    const updatedAgent = await mockApi.updateAgentStatus(agentId, status);\n    if(updatedAgent) {\n        set({ agent: updatedAgent });\n    }\n  },\n  updateProfile: async (agentId, updates) => {\n    const updatedAgent = await mockApi.updateAgentProfile(agentId, updates);\n    if(updatedAgent) {\n        set({ agent: updatedAgent });\n    }\n  },\n  updateSettings: async (agentId, settings) => {\n    const updatedSettings = await mockApi.updateAgentSettings(agentId, settings);\n    if(updatedSettings) {\n        set({ settings: updatedSettings });\n    }\n  },\n  pollSessionUpdates: async (sessionId: string) => {\n    // This function can now leverage the same helper\n    await _fetchSession(sessionId, set);\n  },\n  extendKey: async (agentId, newKeyString) => {\n    set({ isExtendingKey: true, error: null });\n    try {\n        const updatedKey = await mockApi.extendAgentKey(agentId, newKeyString);\n        if (updatedKey) {\n            set({ key: updatedKey, isExtendingKey: false, shouldInvalidateAliases: true });\n            return true;\n        }\n        set({ isExtendingKey: false });\n        return false;\n    } catch (e) {\n        set({ error: e instanceof Error ? e.message : \"Failed to extend key\", isExtendingKey: false });\n        return false;\n    }\n  },\n  blockCustomer: (ipAddress) => {\n    set(state => {\n      if (!state.settings || state.settings.blockedIps.includes(ipAddress)) return {};\n      const newSettings = {\n        ...state.settings,\n        blockedIps: [...state.settings.blockedIps, ipAddress],\n      };\n      mockApi.updateAgentSettings(state.agent!.id, newSettings);\n      return { settings: newSettings };\n    });\n  },\n  unblockCustomer: (ipAddress) => {\n    set(state => {\n      if (!state.settings) return {};\n      const newSettings = {\n        ...state.settings,\n        blockedIps: state.settings.blockedIps.filter(ip => ip !== ipAddress),\n      };\n      mockApi.updateAgentSettings(state.agent!.id, newSettings);\n      return { settings: newSettings };\n    });\n  },\n  deleteCustomer: (customerId) => {\n    set(state => {\n        const sessionsToRemove = state.sessions.filter(s => s.customerId === customerId).map(s => s.id);\n        \n        const newSessions = state.sessions.filter(s => s.customerId !== customerId);\n        const newCustomers = state.customers.filter(c => c.id !== customerId);\n        \n        let newActiveSessionId = state.activeSessionId;\n        if(sessionsToRemove.includes(state.activeSessionId || '')) {\n            newActiveSessionId = newSessions[0]?.id || null;\n        }\n\n        mockApi.deleteCustomer(customerId);\n\n        return {\n            sessions: newSessions,\n            customers: newCustomers,\n            activeSessionId: newActiveSessionId\n        }\n    });\n  },\n  archiveSession: async (sessionId) => {\n    const updatedSession = await mockApi.updateSessionStatus(sessionId, 'archived');\n    if (updatedSession) {\n      set(state => {\n        const otherSessions = state.sessions.filter(s => s.status !== 'archived' && s.id !== sessionId);\n        return {\n          sessions: state.sessions.map(s => s.id === sessionId ? updatedSession : s),\n          activeSessionId: otherSessions[0]?.id || null,\n        }\n      });\n    }\n  },\n  unarchiveSession: async (sessionId) => {\n    const updatedSession = await mockApi.updateSessionStatus(sessionId, 'active');\n    if(updatedSession) {\n      set(state => ({\n        sessions: state.sessions.map(s => s.id === sessionId ? updatedSession : s),\n        activeSessionId: sessionId,\n      }));\n    }\n  },\n  sendFileMessage: async (sessionId, file) => {\n    const agentId = get().agent?.id;\n    if (!agentId) return;\n\n    // 1. Create a temporary message and send to API to get a real ID\n    const tempFileMessage: Omit<FileChatMessage, 'id'> = {\n        type: 'file',\n        sender: 'agent',\n        agentId: agentId,\n        timestamp: new Date().toISOString(),\n        file: {\n            name: file.name,\n            size: file.size,\n            progress: 0,\n        }\n    };\n    \n    // This will add the message to the mock API's session and return it with an ID\n    const persistedMessage = await mockApi.sendMessage(sessionId, tempFileMessage as FileChatMessage) as FileChatMessage;\n    \n    // 2. Add the message with its new ID to the local state\n    set(state => ({\n        sessions: state.sessions.map(s => \n            s.id === sessionId ? { ...s, messages: [...s.messages, persistedMessage] } : s\n        )\n    }));\n\n    // 3. Simulate upload progress on the now-persisted message\n    const interval = setInterval(() => {\n        set(state => {\n            const currentSession = state.sessions.find(s => s.id === sessionId);\n            if (!currentSession) {\n                clearInterval(interval);\n                return state;\n            }\n            \n            const messageToUpdate = currentSession.messages.find(m => m.id === persistedMessage.id) as FileChatMessage | undefined;\n            if (!messageToUpdate) {\n                clearInterval(interval);\n                return state;\n            }\n\n            const currentProgress = messageToUpdate.file.progress;\n            const nextProgress = Math.min(currentProgress + Math.random() * 25, 100);\n            \n            const updatedMessage = {\n                ...messageToUpdate,\n                file: { ...messageToUpdate.file, progress: nextProgress }\n            };\n\n            if (nextProgress >= 100) {\n                clearInterval(interval);\n            }\n            \n            return {\n                ...state,\n                sessions: state.sessions.map(s => \n                    s.id === sessionId ? {\n                        ...s,\n                        messages: s.messages.map(m => m.id === persistedMessage.id ? updatedMessage : m)\n                    } : s\n                )\n            };\n        });\n    }, 500);\n  },\n  invalidateAliases: () => set({ shouldInvalidateAliases: true }),\n  aliasesInvalidated: () => set({ shouldInvalidateAliases: false }),\n}));\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 285, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/avatar.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n"],"names":[],"mappings":";;;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,uBAAS,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG5B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,kKAAA,CAAA,OAAoB;QACnB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,iEACA;QAED,GAAG,KAAK;;;;;;AAGb,OAAO,WAAW,GAAG,kKAAA,CAAA,OAAoB,CAAC,WAAW;AAErD,MAAM,4BAAc,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,kKAAA,CAAA,QAAqB;QACpB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,+BAA+B;QAC5C,GAAG,KAAK;;;;;;AAGb,YAAY,WAAW,GAAG,kKAAA,CAAA,QAAqB,CAAC,WAAW;AAE3D,MAAM,+BAAiB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGpC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,kKAAA,CAAA,WAAwB;QACvB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,wEACA;QAED,GAAG,KAAK;;;;;;AAGb,eAAe,WAAW,GAAG,kKAAA,CAAA,WAAwB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 336, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/dropdown-menu.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAEA;AACA;AACA;AAAA;AAAA;AAEA;AANA;;;;;;AAQA,MAAM,eAAe,4KAAA,CAAA,OAA0B;AAE/C,MAAM,sBAAsB,4KAAA,CAAA,UAA6B;AAEzD,MAAM,oBAAoB,4KAAA,CAAA,QAA2B;AAErD,MAAM,qBAAqB,4KAAA,CAAA,SAA4B;AAEvD,MAAM,kBAAkB,4KAAA,CAAA,MAAyB;AAEjD,MAAM,yBAAyB,4KAAA,CAAA,aAAgC;AAE/D,MAAM,uCAAyB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAK5C,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBAC3C,8OAAC,4KAAA,CAAA,aAAgC;QAC/B,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,0MACA,SAAS,QACT;QAED,GAAG,KAAK;;YAER;0BACD,8OAAC,sNAAA,CAAA,eAAY;gBAAC,WAAU;;;;;;;;;;;;AAG5B,uBAAuB,WAAW,GAChC,4KAAA,CAAA,aAAgC,CAAC,WAAW;AAE9C,MAAM,uCAAyB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG5C,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,4KAAA,CAAA,aAAgC;QAC/B,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,ybACA;QAED,GAAG,KAAK;;;;;;AAGb,uBAAuB,WAAW,GAChC,4KAAA,CAAA,aAAgC,CAAC,WAAW;AAE9C,MAAM,oCAAsB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGzC,CAAC,EAAE,SAAS,EAAE,aAAa,CAAC,EAAE,GAAG,OAAO,EAAE,oBAC1C,8OAAC,4KAAA,CAAA,SAA4B;kBAC3B,cAAA,8OAAC,4KAAA,CAAA,UAA6B;YAC5B,KAAK;YACL,YAAY;YACZ,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,ybACA;YAED,GAAG,KAAK;;;;;;;;;;;AAIf,oBAAoB,WAAW,GAAG,4KAAA,CAAA,UAA6B,CAAC,WAAW;AAE3E,MAAM,iCAAmB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAKtC,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,GAAG,OAAO,EAAE,oBACjC,8OAAC,4KAAA,CAAA,OAA0B;QACzB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,qSACA,SAAS,QACT;QAED,GAAG,KAAK;;;;;;AAGb,iBAAiB,WAAW,GAAG,4KAAA,CAAA,OAA0B,CAAC,WAAW;AAErE,MAAM,yCAA2B,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG9C,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,OAAO,EAAE,GAAG,OAAO,EAAE,oBAC7C,8OAAC,4KAAA,CAAA,eAAkC;QACjC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,wOACA;QAEF,SAAS;QACR,GAAG,KAAK;;0BAET,8OAAC;gBAAK,WAAU;0BACd,cAAA,8OAAC,4KAAA,CAAA,gBAAmC;8BAClC,cAAA,8OAAC,oMAAA,CAAA,QAAK;wBAAC,WAAU;;;;;;;;;;;;;;;;YAGpB;;;;;;;AAGL,yBAAyB,WAAW,GAClC,4KAAA,CAAA,eAAkC,CAAC,WAAW;AAEhD,MAAM,sCAAwB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG3C,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,8OAAC,4KAAA,CAAA,YAA+B;QAC9B,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,wOACA;QAED,GAAG,KAAK;;0BAET,8OAAC;gBAAK,WAAU;0BACd,cAAA,8OAAC,4KAAA,CAAA,gBAAmC;8BAClC,cAAA,8OAAC,sMAAA,CAAA,SAAM;wBAAC,WAAU;;;;;;;;;;;;;;;;YAGrB;;;;;;;AAGL,sBAAsB,WAAW,GAAG,4KAAA,CAAA,YAA+B,CAAC,WAAW;AAE/E,MAAM,kCAAoB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAKvC,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,GAAG,OAAO,EAAE,oBACjC,8OAAC,4KAAA,CAAA,QAA2B;QAC1B,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,qCACA,SAAS,QACT;QAED,GAAG,KAAK;;;;;;AAGb,kBAAkB,WAAW,GAAG,4KAAA,CAAA,QAA2B,CAAC,WAAW;AAEvE,MAAM,sCAAwB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG3C,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,4KAAA,CAAA,YAA+B;QAC9B,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,4BAA4B;QACzC,GAAG,KAAK;;;;;;AAGb,sBAAsB,WAAW,GAAG,4KAAA,CAAA,YAA+B,CAAC,WAAW;AAE/E,MAAM,uBAAuB,CAAC,EAC5B,SAAS,EACT,GAAG,OACmC;IACtC,qBACE,8OAAC;QACC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,8CAA8C;QAC3D,GAAG,KAAK;;;;;;AAGf;AACA,qBAAqB,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 534, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/dialog.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;AAEA;AACA;AACA;AAEA;AANA;;;;;;AAQA,MAAM,SAAS,kKAAA,CAAA,OAAoB;AAEnC,MAAM,gBAAgB,kKAAA,CAAA,UAAuB;AAE7C,MAAM,eAAe,kKAAA,CAAA,SAAsB;AAE3C,MAAM,cAAc,kKAAA,CAAA,QAAqB;AAEzC,MAAM,8BAAgB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGnC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,kKAAA,CAAA,UAAuB;QACtB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,0JACA;QAED,GAAG,KAAK;;;;;;AAGb,cAAc,WAAW,GAAG,kKAAA,CAAA,UAAuB,CAAC,WAAW;AAE/D,MAAM,8BAAgB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGnC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,8OAAC;;0BACC,8OAAC;;;;;0BACD,8OAAC,kKAAA,CAAA,UAAuB;gBACtB,KAAK;gBACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,+fACA;gBAED,GAAG,KAAK;;oBAER;kCACD,8OAAC,kKAAA,CAAA,QAAqB;wBAAC,WAAU;;0CAC/B,8OAAC,4LAAA,CAAA,IAAC;gCAAC,WAAU;;;;;;0CACb,8OAAC;gCAAK,WAAU;0CAAU;;;;;;;;;;;;;;;;;;;;;;;;AAKlC,cAAc,WAAW,GAAG,kKAAA,CAAA,UAAuB,CAAC,WAAW;AAE/D,MAAM,eAAe,CAAC,EACpB,SAAS,EACT,GAAG,OACkC,iBACrC,8OAAC;QACC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,sDACA;QAED,GAAG,KAAK;;;;;;AAGb,aAAa,WAAW,GAAG;AAE3B,MAAM,eAAe,CAAC,EACpB,SAAS,EACT,GAAG,OACkC,iBACrC,8OAAC;QACC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,iEACA;QAED,GAAG,KAAK;;;;;;AAGb,aAAa,WAAW,GAAG;AAE3B,MAAM,4BAAc,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,kKAAA,CAAA,QAAqB;QACpB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,qDACA;QAED,GAAG,KAAK;;;;;;AAGb,YAAY,WAAW,GAAG,kKAAA,CAAA,QAAqB,CAAC,WAAW;AAE3D,MAAM,kCAAoB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGvC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,kKAAA,CAAA,cAA2B;QAC1B,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,kBAAkB,WAAW,GAAG,kKAAA,CAAA,cAA2B,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 666, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/tabs.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,OAAO,gKAAA,CAAA,OAAkB;AAE/B,MAAM,yBAAW,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG9B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,gKAAA,CAAA,OAAkB;QACjB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,8FACA;QAED,GAAG,KAAK;;;;;;AAGb,SAAS,WAAW,GAAG,gKAAA,CAAA,OAAkB,CAAC,WAAW;AAErD,MAAM,4BAAc,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,gKAAA,CAAA,UAAqB;QACpB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,uYACA;QAED,GAAG,KAAK;;;;;;AAGb,YAAY,WAAW,GAAG,gKAAA,CAAA,UAAqB,CAAC,WAAW;AAE3D,MAAM,4BAAc,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,gKAAA,CAAA,UAAqB;QACpB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,mIACA;QAED,GAAG,KAAK;;;;;;AAGb,YAAY,WAAW,GAAG,gKAAA,CAAA,UAAqB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 719, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/label.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAEA;AANA;;;;;;AAQA,MAAM,gBAAgB,CAAA,GAAA,gKAAA,CAAA,MAAG,AAAD,EACtB;AAGF,MAAM,sBAAQ,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAI3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,iKAAA,CAAA,OAAmB;QAClB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iBAAiB;QAC9B,GAAG,KAAK;;;;;;AAGb,MAAM,WAAW,GAAG,iKAAA,CAAA,OAAmB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 751, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/input.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n"],"names":[],"mappings":";;;;AAAA;AAEA;;;;AAEA,MAAM,sBAAQ,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAC3B,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAO,EAAE;IAC9B,qBACE,8OAAC;QACC,MAAM;QACN,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,gWACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,MAAM,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 780, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAEA;;;;;;AAEA,MAAM,iBAAiB,CAAA,GAAA,gKAAA,CAAA,MAAG,AAAD,EACvB,4VACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OAAO;YACP,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;QACR;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AASF,MAAM,uBAAS,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAC5B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,KAAK,EAAE,GAAG,OAAO,EAAE;IACxD,MAAM,OAAO,UAAU,gKAAA,CAAA,OAAI,GAAG;IAC9B,qBACE,8OAAC;QACC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,eAAe;YAAE;YAAS;YAAM;QAAU;QACxD,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,OAAO,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 840, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/textarea.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport {cn} from '@/lib/utils';\n\nconst Textarea = React.forwardRef<HTMLTextAreaElement, React.ComponentProps<'textarea'>>(\n  ({className, ...props}, ref) => {\n    return (\n      <textarea\n        className={cn(\n          'flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    );\n  }\n);\nTextarea.displayName = 'Textarea';\n\nexport {Textarea};\n"],"names":[],"mappings":";;;;AAAA;AAEA;;;;AAEA,MAAM,yBAAW,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAC9B,CAAC,EAAC,SAAS,EAAE,GAAG,OAAM,EAAE;IACtB,qBACE,8OAAC;QACC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,qTACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,SAAS,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 868, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/switch.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n"],"names":[],"mappings":";;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,uBAAS,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG5B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,kKAAA,CAAA,OAAqB;QACpB,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,sXACA;QAED,GAAG,KAAK;QACT,KAAK;kBAEL,cAAA,8OAAC,kKAAA,CAAA,QAAsB;YACrB,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV;;;;;;;;;;;AAKR,OAAO,WAAW,GAAG,kKAAA,CAAA,OAAqB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 904, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/alert.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,CAAA,GAAA,gKAAA,CAAA,MAAG,AAAD,EACtB,6JACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,MAAM,sBAAQ,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG3B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,OAAO,EAAE,oBACnC,8OAAC;QACC,KAAK;QACL,MAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGb,MAAM,WAAW,GAAG;AAEpB,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,gDAAgD;QAC7D,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,iCAAmB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,iBAAiB,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 968, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/agent/AgentSettingsDialog.tsx"],"sourcesContent":["\n\n\"use client\";\n\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter } from \"../ui/dialog\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"../ui/tabs\";\nimport { useAgentStore } from \"@/lib/stores/agentStore\";\nimport { useAuthStore } from \"@/lib/stores/authStore\";\nimport { Label } from \"../ui/label\";\nimport { Input } from \"../ui/input\";\nimport { Button } from \"../ui/button\";\nimport { Textarea } from \"../ui/textarea\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useState, useEffect, useRef } from \"react\";\nimport type { AgentSettings, QuickReply } from \"@/lib/types\";\nimport { PlusCircle, Trash, KeyRound, Bell, Loader2, Edit, Save, ArrowUp } from \"lucide-react\";\nimport { format, formatDistanceToNow, parseISO } from \"date-fns\";\nimport { zhCN } from 'date-fns/locale';\nimport { Switch } from \"../ui/switch\";\nimport { Alert, AlertDescription, AlertTitle } from \"../ui/alert\";\n\n\ninterface AgentSettingsDialogProps {\n    isOpen: boolean;\n    setIsOpen: (open: boolean) => void;\n}\n\nexport function AgentSettingsDialog({ isOpen, setIsOpen }: AgentSettingsDialogProps) {\n    const { agent, settings, key, updateProfile, updateSettings, extendKey, isExtendingKey, error, invalidateAliases } = useAgentStore();\n    const { updateCurrentUser } = useAuthStore();\n    const { toast } = useToast();\n    \n    const [name, setName] = useState(agent?.name || \"\");\n    const [welcomeMessages, setWelcomeMessages] = useState<string[]>([\"\", \"\"]);\n    const [quickReplies, setQuickReplies] = useState<QuickReply[]>([]);\n    const [showReminder, setShowReminder] = useState(true);\n    const [newKey, setNewKey] = useState(\"\");\n    const [editingReplyId, setEditingReplyId] = useState<string | null>(null);\n    const avatarInputRef = useRef<HTMLInputElement>(null);\n\n\n    useEffect(() => {\n        if(agent) setName(agent.name);\n        if(settings) {\n            setWelcomeMessages([\n                settings.welcomeMessages?.[0] || \"\",\n                settings.welcomeMessages?.[1] || \"\",\n            ]);\n            setQuickReplies(settings.quickReplies || []);\n        } else {\n            setWelcomeMessages([\"\",\"\"]);\n            setQuickReplies([]);\n        }\n        setNewKey(\"\"); // Reset on open\n        setEditingReplyId(null); // Reset editing state on open\n    }, [agent, settings, isOpen]);\n\n    useEffect(() => {\n        if (!key?.expiresAt || !showReminder) return;\n\n        const checkExpiration = () => {\n            const expiresIn = parseISO(key.expiresAt!).getTime() - Date.now();\n            const oneHour = 60 * 60 * 1000;\n            if (expiresIn > 0 && expiresIn < oneHour) {\n                toast({\n                    title: \"密钥即将到期提醒\",\n                    description: `您的坐席密钥将在大约一小时内到期。请及时更换。`,\n                });\n            }\n        };\n\n        const interval = setInterval(checkExpiration, 60 * 1000); // Check every minute\n        return () => clearInterval(interval);\n    }, [key, showReminder, toast]);\n\n    if (!agent) return null;\n\n    const handleProfileSave = async () => {\n        await updateProfile(agent.id, { name });\n        updateCurrentUser({ name });\n        toast({ title: \"个人资料已更新\", description: \"您的显示名称已更改。\" });\n    };\n\n    const handleGenerateAvatar = async () => {\n        const newAvatar = `https://i.pravatar.cc/150?u=${Date.now()}`;\n        await updateProfile(agent.id, { avatar: newAvatar });\n        updateCurrentUser({ avatar: newAvatar });\n        toast({ title: \"头像已更新\", description: \"已生成新的随机头像。\" });\n    }\n    \n    const handleAvatarUploadClick = () => {\n        avatarInputRef.current?.click();\n    };\n\n    const handleFileChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n        const file = event.target.files?.[0];\n        if (file) {\n            const reader = new FileReader();\n            reader.onloadend = async () => {\n                const newAvatar = reader.result as string;\n                await updateProfile(agent!.id, { avatar: newAvatar });\n                updateCurrentUser({ avatar: newAvatar });\n                toast({ title: \"头像已更新\", description: \"您的头像已成功上传。\" });\n            };\n            reader.readAsDataURL(file);\n        }\n    };\n    \n    const handleSettingsSave = async () => {\n        const filteredWelcomeMessages = welcomeMessages.filter(m => m.trim() !== \"\");\n        const finalQuickReplies = quickReplies.filter(qr => qr.shortcut.trim() !== '' && qr.message.trim() !== '');\n        \n        const newSettings: AgentSettings = { ...settings!, welcomeMessages: filteredWelcomeMessages, quickReplies: finalQuickReplies };\n        \n        await updateSettings(agent.id, newSettings);\n        toast({ title: \"设置已保存\", description: \"您的聊天设置已更新。\" });\n        setEditingReplyId(null);\n    }\n\n    const addQuickReply = () => {\n        const newId = `new-${Date.now()}`;\n        setQuickReplies(prev => [...prev, { id: newId, shortcut: \"\", message: \"\" }]);\n        setEditingReplyId(newId);\n    }\n    \n    const updateQuickReply = (id: string, field: 'shortcut' | 'message', value: string) => {\n        setQuickReplies(prev => prev.map(qr => qr.id === id ? { ...qr, [field]: value } : qr));\n    }\n    \n    const removeQuickReply = (id: string) => {\n        setQuickReplies(prev => prev.filter(qr => qr.id !== id));\n    }\n    \n    const getRemainingTime = () => {\n        if(!key?.expiresAt) return \"无到期限制\";\n        const expiresDate = parseISO(key.expiresAt);\n        if (expiresDate < new Date()) {\n            return \"已过期\";\n        }\n        return formatDistanceToNow(expiresDate, { addSuffix: true, locale: zhCN });\n    }\n\n    const handleExtendKey = async () => {\n        if (!newKey.trim() || !agent) return;\n        const success = await extendKey(agent.id, newKey);\n        if(success) {\n            toast({\n                title: \"密钥已更换\",\n                description: \"坐席已成功绑定新密钥。旧分享链接已失效，请重新生成。\",\n            });\n            invalidateAliases(); // This will trigger the ShareDialog to refetch a new URL\n            setNewKey(\"\");\n        } else {\n             toast({\n                title: \"更换失败\",\n                description: error || \"无法使用该密钥。请检查密钥是否正确、未绑定且为坐席角色。\",\n                variant: \"destructive\"\n            })\n        }\n    }\n    \n    const handleMoveUp = (index: number) => {\n        if (index === 0) return;\n        setQuickReplies(prev => {\n            const newReplies = [...prev];\n            const temp = newReplies[index];\n            newReplies[index] = newReplies[index - 1];\n            newReplies[index - 1] = temp;\n            return newReplies;\n        });\n    };\n\n    return (\n        <Dialog open={isOpen} onOpenChange={setIsOpen}>\n            <DialogContent className=\"max-w-2xl\">\n                <DialogHeader>\n                    <DialogTitle>坐席设置</DialogTitle>\n                    <DialogDescription>管理您的个人资料和聊天设置。</DialogDescription>\n                </DialogHeader>\n                <Tabs defaultValue=\"profile\">\n                    <TabsList className=\"grid w-full grid-cols-3\">\n                        <TabsTrigger value=\"profile\">个人资料</TabsTrigger>\n                        <TabsTrigger value=\"chat\">聊天设置</TabsTrigger>\n                        <TabsTrigger value=\"key\">密钥管理</TabsTrigger>\n                    </TabsList>\n                    <TabsContent value=\"profile\" className=\"p-1\">\n                        <div className=\"space-y-4 py-4\">\n                            <div className=\"space-y-2\">\n                                <Label htmlFor=\"name\">显示名称</Label>\n                                <Input id=\"name\" value={name} onChange={(e) => setName(e.target.value)} />\n                            </div>\n                            <Button onClick={handleProfileSave}>保存名称</Button>\n                        </div>\n                         <div className=\"space-y-4 py-4\">\n                            <div className=\"space-y-2\">\n                                <Label>头像</Label>\n                                <p className=\"text-sm text-muted-foreground\">上传您自己的头像或生成一个随机头像。</p>\n                                 <div className=\"flex items-center gap-2\">\n                                    <Button onClick={handleAvatarUploadClick}>上传头像</Button>\n                                    <Button variant=\"outline\" onClick={handleGenerateAvatar}>生成随机头像</Button>\n                                </div>\n                                <input \n                                    type=\"file\" \n                                    ref={avatarInputRef} \n                                    onChange={handleFileChange} \n                                    className=\"hidden\" \n                                    accept=\"image/*\"\n                                />\n                            </div>\n                        </div>\n                    </TabsContent>\n                    <TabsContent value=\"chat\" className=\"p-1\">\n                        <div className=\"space-y-6 py-4\">\n                            <div className=\"space-y-2\">\n                                <Label>欢迎消息</Label>\n                                <p className=\"text-sm text-muted-foreground\">设置一或两条欢迎语，它们将依次发送给访客。</p>\n                                <Textarea \n                                    value={welcomeMessages[0]} \n                                    onChange={(e) => setWelcomeMessages([e.target.value, welcomeMessages[1]])} \n                                    placeholder=\"第一条欢迎消息 (必填)\" \n                                />\n                                <Textarea \n                                     value={welcomeMessages[1]} \n                                     onChange={(e) => setWelcomeMessages([welcomeMessages[0], e.target.value])} \n                                     placeholder=\"第二条欢迎消息 (可选，将在3秒后发送)\" \n                                />\n                            </div>\n                            <div className=\"space-y-4\">\n                                <div>\n                                    <Label>快捷回复</Label>\n                                    <p className=\"text-sm text-muted-foreground\">输入您的常用语录，方便快速回复。</p>\n                                </div>\n                                <div className=\"space-y-2 max-h-48 overflow-y-auto pr-2\">\n                                    {quickReplies.map((qr, index) => (\n                                         <div key={qr.id} className=\"flex items-center gap-2 p-2 rounded-md border bg-background\">\n                                            \n                                            {editingReplyId === qr.id ? (\n                                                <>\n                                                     <Button disabled variant=\"ghost\" size=\"icon\" className=\"h-8 w-8 cursor-default\">\n                                                        <ArrowUp className=\"h-4 w-4\" />\n                                                    </Button>\n                                                    <Input placeholder=\"快捷指令\" value={qr.shortcut} onChange={e => updateQuickReply(qr.id, 'shortcut', e.target.value)} className=\"w-28\"/>\n                                                    <Input placeholder=\"快捷回复内容\" className=\"flex-1\" value={qr.message} onChange={e => updateQuickReply(qr.id, 'message', e.target.value)} />\n                                                    <Button variant=\"ghost\" size=\"icon\" onClick={() => setEditingReplyId(null)}><Save className=\"h-4 w-4 text-primary\"/></Button>\n                                                </>\n                                            ) : (\n                                                <>\n                                                    <Button variant=\"ghost\" size=\"icon\" onClick={() => handleMoveUp(index)} className=\"h-8 w-8\" disabled={index === 0}>\n                                                        <ArrowUp className=\"h-4 w-4\" />\n                                                    </Button>\n                                                    <code className=\"px-2 py-1 bg-muted rounded-md text-sm font-semibold w-28 text-center truncate\">{qr.shortcut}</code>\n                                                    <p className=\"flex-1 text-sm text-muted-foreground truncate\">{qr.message}</p>\n                                                    <Button variant=\"ghost\" size=\"icon\" onClick={() => setEditingReplyId(qr.id)}><Edit className=\"h-4 w-4\"/></Button>\n                                                    <Button variant=\"ghost\" size=\"icon\" onClick={() => removeQuickReply(qr.id)}><Trash className=\"h-4 w-4 text-destructive\"/></Button>\n                                                </>\n                                            )}\n                                        </div>\n                                    ))}\n                                </div>\n                                <Button variant=\"outline\" size=\"sm\" onClick={addQuickReply}><PlusCircle className=\"h-4 w-4 mr-2\"/>添加回复</Button>\n                            </div>\n                        </div>\n                         <Button onClick={handleSettingsSave}>保存聊天设置</Button>\n                    </TabsContent>\n                    <TabsContent value=\"key\" className=\"p-1\">\n                        <div className=\"space-y-6 py-4\">\n                             <Alert>\n                                <KeyRound className=\"h-4 w-4\" />\n                                <AlertTitle>当前密钥信息</AlertTitle>\n                                <AlertDescription>\n                                    <div className=\"mt-2 space-y-2 text-sm\">\n                                        <div className=\"flex justify-between\">\n                                            <span className=\"text-muted-foreground\">绑定坐席</span>\n                                            <span>{agent.name}</span>\n                                        </div>\n                                        <div className=\"flex justify-between\">\n                                            <span className=\"text-muted-foreground\">当前密钥</span>\n                                            <code className=\"text-xs\">{key?.key}</code>\n                                        </div>\n                                        <div className=\"flex justify-between\">\n                                            <span className=\"text-muted-foreground\">到期时间</span>\n                                            <span className=\"font-semibold\">{getRemainingTime()}</span>\n                                        </div>\n                                    </div>\n                                </AlertDescription>\n                            </Alert>\n                            \n                             <div className=\"space-y-2\">\n                                <Label htmlFor=\"extend-key\">更换绑定密钥</Label>\n                                <p className=\"text-sm text-muted-foreground\">粘贴一个新的、未绑定的坐席密钥来替换当前密钥，以继续使用坐席服务。旧密钥将会失效。</p>\n                                <div className=\"flex gap-2\">\n                                    <Input \n                                        id=\"extend-key\" \n                                        placeholder=\"在此处粘贴新密钥\" \n                                        value={newKey}\n                                        onChange={(e) => setNewKey(e.target.value)}\n                                        disabled={isExtendingKey}\n                                    />\n                                    <Button onClick={handleExtendKey} disabled={isExtendingKey || !newKey}>\n                                        {isExtendingKey && <Loader2 className=\"animate-spin\" />}\n                                        更换密钥\n                                    </Button>\n                                </div>\n                            </div>\n\n                             <div className=\"space-y-2\">\n                                <Label>提醒</Label>\n                                <div className=\"flex items-center justify-between rounded-lg border p-3 shadow-sm\">\n                                    <div className=\"space-y-0.5\">\n                                        <p className=\"text-sm font-medium\">到期提醒</p>\n                                        <p className=\"text-xs text-muted-foreground\">\n                                           在密钥到期前1小时，系统将弹出友好提示。\n                                        </p>\n                                    </div>\n                                    <Switch checked={showReminder} onCheckedChange={setShowReminder} />\n                                </div>\n                            </div>\n                        </div>\n                    </TabsContent>\n                </Tabs>\n            </DialogContent>\n        </Dialog>\n    );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1916, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/radio-group.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAEA;AANA;;;;;;AAQA,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE;IAC1B,qBACE,8OAAC,0KAAA,CAAA,OAAwB;QACvB,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,cAAc;QAC3B,GAAG,KAAK;QACT,KAAK;;;;;;AAGX;AACA,WAAW,WAAW,GAAG,0KAAA,CAAA,OAAwB,CAAC,WAAW;AAE7D,MAAM,+BAAiB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGpC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE;IAC1B,qBACE,8OAAC,0KAAA,CAAA,OAAwB;QACvB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,4OACA;QAED,GAAG,KAAK;kBAET,cAAA,8OAAC,0KAAA,CAAA,YAA6B;YAAC,WAAU;sBACvC,cAAA,8OAAC,sMAAA,CAAA,SAAM;gBAAC,WAAU;;;;;;;;;;;;;;;;AAI1B;AACA,eAAe,WAAW,GAAG,0KAAA,CAAA,OAAwB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 1976, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/shared/SegmentedControl.tsx"],"sourcesContent":["\n\"use client\";\n\nimport * as React from \"react\";\nimport { RadioGroup, RadioGroupItem } from \"@/components/ui/radio-group\";\nimport { Label } from \"@/components/ui/label\";\nimport { cn } from \"@/lib/utils\";\n\ninterface SegmentedControlProps {\n    options: {\n        value: string;\n        label: string;\n        icon?: React.ElementType;\n        disabled?: boolean;\n    }[];\n    value: string;\n    onValueChange: (value: string) => void;\n    className?: string;\n}\n\nexport function SegmentedControl({ options, value, onValueChange, className }: SegmentedControlProps) {\n    return (\n        <RadioGroup\n            value={value}\n            onValueChange={onValueChange}\n            className={cn(\"grid w-full grid-cols-3 gap-2 rounded-lg bg-muted p-1\", className)}\n        >\n            {options.map((option) => (\n                <div key={option.value}>\n                    <RadioGroupItem value={option.value} id={option.value} className=\"peer sr-only\" disabled={option.disabled} />\n                    <Label\n                        htmlFor={option.value}\n                        className={cn(\n                            \"flex flex-col items-center justify-center rounded-md border-2 border-muted bg-muted p-2 text-sm font-medium hover:bg-accent hover:text-accent-foreground peer-data-[state=checked]:border-primary [&:has([data-state=checked])]:border-primary\",\n                             \"cursor-pointer peer-disabled:cursor-not-allowed peer-disabled:opacity-50\"\n                        )}\n                    >\n                         {option.icon && <option.icon className=\"mb-1 h-5 w-5\" />}\n                        {option.label}\n                    </Label>\n                </div>\n            ))}\n        </RadioGroup>\n    );\n}\n"],"names":[],"mappings":";;;;AAIA;AACA;AACA;AALA;;;;;AAmBO,SAAS,iBAAiB,EAAE,OAAO,EAAE,KAAK,EAAE,aAAa,EAAE,SAAS,EAAyB;IAChG,qBACI,8OAAC,0IAAA,CAAA,aAAU;QACP,OAAO;QACP,eAAe;QACf,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,yDAAyD;kBAEtE,QAAQ,GAAG,CAAC,CAAC,uBACV,8OAAC;;kCACG,8OAAC,0IAAA,CAAA,iBAAc;wBAAC,OAAO,OAAO,KAAK;wBAAE,IAAI,OAAO,KAAK;wBAAE,WAAU;wBAAe,UAAU,OAAO,QAAQ;;;;;;kCACzG,8OAAC,iIAAA,CAAA,QAAK;wBACF,SAAS,OAAO,KAAK;wBACrB,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACR,kPACC;;4BAGH,OAAO,IAAI,kBAAI,8OAAC,OAAO,IAAI;gCAAC,WAAU;;;;;;4BACvC,OAAO,KAAK;;;;;;;;eAVX,OAAO,KAAK;;;;;;;;;;AAgBtC","debugId":null}},
    {"offset": {"line": 2041, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/agent/ShareDialog.tsx"],"sourcesContent":["\n\n\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter } from \"../ui/dialog\";\nimport { Input } from \"../ui/input\";\nimport { Button } from \"../ui/button\";\nimport { Copy, Download, Loader2, Image as ImageIcon, User, Code, Headset } from \"lucide-react\";\nimport { useAuthStore } from \"@/lib/stores/authStore\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport QRCode, { QRCodeProps } from \"qrcode.react\";\nimport { mockApi } from \"@/lib/mock-api\";\nimport { SegmentedControl } from \"../shared/SegmentedControl\";\nimport { useAgentStore } from \"@/lib/stores/agentStore\";\nimport type { Alias } from \"@/lib/types\";\n\ninterface ShareDialogProps {\n    isOpen: boolean;\n    setIsOpen: (open: boolean) => void;\n}\n\nconst APP_ICON_SVG_DATA_URL = \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLWhlYWRzZXQiPjxwYXRoIGQ9Ik0xOCAxN2ExIDAgMCAxLSAxIDEgNiA2IDAgMCAxLTYgNnYxYTEgMSAwIDAgMSA1IDIuNUE4LjUgOC41IDAgMCAwIDE4IDE3WiIvPjxwYXRoIGQ9Ik0xOCAxN2ExIDAgMCAxLSAxIDEgNiA2IDAgMCAxLTYgNnYxYTEgMSAwIDAgMSAxIDAgNCA0IDAgMCAwIDQtNEgxN2ExIDEgMCAwIDEgMS0xWiIvPjxwYXRoIGQ9Im0xNSA1IgMiAyLTMgMy0yLTJ6bS0zIDRMNyAxNWw1IDUiLz48cGF0aCBkPSJNMy41IDIwLjVDMi42IDIwLjUgMiAxOS45IDIgMTl2LTZzMC00IDQgNGwwIDJjMCAxLjEgMCAxLjEtMSAxLjEtMS4xIDAtMS4xIDAtMS4xLTEuMVoiLz48L3N2Zz4=\";\n\nexport function ShareDialog({ isOpen, setIsOpen }: ShareDialogProps) {\n    const { user } = useAuthStore();\n    const { agent, shouldInvalidateAliases, aliasesInvalidated } = useAgentStore();\n    const { toast } = useToast();\n    const [alias, setAlias] = useState<Alias | null>(null);\n    const [shareUrl, setShareUrl] = useState(\"\");\n    const [isLoading, setIsLoading] = useState(false);\n    const [qrStyle, setQrStyle] = useState<\"none\" | \"icon\" | \"avatar\">(\"none\");\n    const [qrImageSrc, setQrImageSrc] = useState<string | null>(null);\n\n    useEffect(() => {\n        const generateUrl = async () => {\n            if (user?.id) {\n                setIsLoading(true);\n                try {\n                    // This function now intelligently gets an existing valid alias or creates a new one.\n                    const aliasData = await mockApi.getOrCreateAlias(user.id);\n                    if (aliasData) {\n                        setAlias(aliasData);\n                        const baseUrl = window.location.origin;\n                        const url = `${baseUrl}/naoiod/${aliasData.token}`;\n                        setShareUrl(url);\n                    } else {\n                         toast({ title: \"错误\", description: \"无法生成分享链接，请稍后重试。\", variant: \"destructive\" });\n                    }\n                } catch (e) {\n                    toast({ title: \"错误\", description: \"无法生成分享链接。\", variant: \"destructive\" });\n                } finally {\n                    setIsLoading(false);\n                }\n            }\n        };\n        \n        // Trigger on open, or if the alias has been invalidated (e.g. by extending a key)\n        if(isOpen) {\n            if(shouldInvalidateAliases) {\n                setShareUrl(\"\"); // Clear the url to show loading and force a refetch\n                aliasesInvalidated(); // Reset the flag in the store\n            }\n             generateUrl();\n        }\n\n    }, [user, isOpen, toast, shouldInvalidateAliases, aliasesInvalidated]);\n\n\n    useEffect(() => {\n        if (qrStyle === 'none') {\n            setQrImageSrc(null);\n        } else if (qrStyle === 'icon') {\n            setQrImageSrc(APP_ICON_SVG_DATA_URL);\n        } else if (qrStyle === 'avatar' && agent?.avatar) {\n            setQrImageSrc(agent.avatar);\n        } else {\n            setQrImageSrc(null);\n        }\n    }, [qrStyle, agent]);\n    \n    const handleCopy = () => {\n        if (!shareUrl) return;\n        navigator.clipboard.writeText(shareUrl);\n        toast({ title: \"已复制！\", description: \"分享链接已复制到剪贴板。\" });\n    }\n\n    const handleDownloadQR = () => {\n        const canvas = document.getElementById('qr-code-canvas') as HTMLCanvasElement;\n        if (canvas) {\n          const pngUrl = canvas\n            .toDataURL(\"image/png\")\n            .replace(\"image/png\", \"image/octet-stream\");\n          let downloadLink = document.createElement(\"a\");\n          downloadLink.href = pngUrl;\n          downloadLink.download = `agentverse-share-qr.png`;\n          document.body.appendChild(downloadLink);\n          downloadLink.click();\n          document.body.removeChild(downloadLink);\n          toast({ title: \"已下载\", description: \"二维码已保存为PNG图片。\" });\n        }\n      };\n    \n    const qrCodeProps: QRCodeProps = {\n        id: \"qr-code-canvas\",\n        value: shareUrl,\n        size: 192,\n        level: \"H\",\n        includeMargin: true,\n        ...(qrImageSrc && {\n            imageSettings: {\n                src: qrImageSrc,\n                height: 35,\n                width: 35,\n                excavate: true,\n            },\n        }),\n    };\n\n    return (\n        <Dialog open={isOpen} onOpenChange={setIsOpen}>\n            <DialogContent className=\"max-w-md\">\n                <DialogHeader>\n                    <DialogTitle>分享您的聊天链接</DialogTitle>\n                    <DialogDescription>\n                        与访客分享此唯一链接或二维码，即可开始与您的专属聊天会话。链接有独立有效期，过期将自动失效。\n                    </DialogDescription>\n                </DialogHeader>\n                <div className=\"flex flex-col items-center gap-6 pt-4\">\n                    <div className=\"p-4 bg-white rounded-lg border\">\n                        {isLoading || !shareUrl ? (\n                            <div className=\"h-[192px] w-[192px] bg-gray-200 animate-pulse rounded-md flex items-center justify-center\">\n                                <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n                            </div>\n                        ) : (\n                            <QRCode {...qrCodeProps} />\n                        )}\n                    </div>\n                     <SegmentedControl\n                        value={qrStyle}\n                        onValueChange={(val) => setQrStyle(val as any)}\n                        options={[\n                            { value: \"none\", label: \"标准\", icon: Code },\n                            { value: \"icon\", label: \"图标\", icon: Headset },\n                            { value: \"avatar\", label: \"头像\", icon: User, disabled: !agent?.avatar },\n                        ]}\n                    />\n\n                    <div className=\"w-full flex items-center gap-2\">\n                        <Input value={shareUrl} placeholder=\"正在生成链接...\" readOnly className=\"text-sm\" />\n                        <Button variant=\"outline\" size=\"icon\" onClick={handleCopy} disabled={!shareUrl}>\n                            <Copy className=\"h-4 w-4\" />\n                        </Button>\n                    </div>\n                </div>\n                <DialogFooter className=\"sm:justify-center\">\n                    <Button onClick={handleDownloadQR} disabled={!shareUrl}>\n                        <Download className=\"mr-2 h-4 w-4\"/>\n                        下载二维码\n                    </Button>\n                </DialogFooter>\n            </DialogContent>\n        </Dialog>\n    );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2351, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/agent/AgentProfile.tsx"],"sourcesContent":["\"use client\";\n\nimport { useAgentStore } from \"@/lib/stores/agentStore\";\nimport { useAuthStore } from \"@/lib/stores/authStore\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"../ui/avatar\";\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuLabel, DropdownMenuRadioGroup, DropdownMenuRadioItem, DropdownMenuSeparator, DropdownMenuTrigger } from \"../ui/dropdown-menu\";\nimport { LogOut, Settings, Share2, Wifi, Bell, Moon } from \"lucide-react\";\nimport { AgentStatus } from \"@/lib/types\";\nimport { AgentSettingsDialog } from \"./AgentSettingsDialog\";\nimport { useState } from \"react\";\nimport { ShareDialog } from \"./ShareDialog\";\n\nexport function AgentProfile() {\n    const { agent, updateStatus } = useAgentStore();\n    const { logout, user } = useAuthStore();\n    const [isSettingsOpen, setIsSettingsOpen] = useState(false);\n    const [isShareOpen, setIsShareOpen] = useState(false);\n\n    if (!agent || !user) return null;\n\n    const handleStatusChange = (status: string) => {\n        updateStatus(agent.id, status as AgentStatus);\n    };\n\n    const getStatusClass = (status: AgentStatus) => {\n        switch(status) {\n            case 'online': return 'bg-green-500';\n            case 'busy': return 'bg-orange-500';\n            case 'offline': return 'text-gray-500';\n        }\n    }\n\n    const translateStatus = (status: AgentStatus) => {\n        switch(status) {\n            case 'online': return '在线';\n            case 'busy': return '忙碌';\n            case 'offline': return '离线';\n        }\n    }\n    \n    return (\n        <>\n            <DropdownMenu>\n                <DropdownMenuTrigger asChild>\n                    <div className=\"w-full flex items-center gap-3 p-2 rounded-lg hover:bg-muted cursor-pointer\">\n                        <div className=\"relative\">\n                            <Avatar className=\"h-10 w-10\">\n                                <AvatarImage src={agent.avatar} />\n                                <AvatarFallback>{agent.name[0]}</AvatarFallback>\n                            </Avatar>\n                            <span className={`absolute bottom-0 right-0 block h-2.5 w-2.5 rounded-full border-2 border-background ${getStatusClass(agent.status)}`} />\n                        </div>\n                        <div className=\"flex-1 overflow-hidden\">\n                            <p className=\"font-semibold truncate\">{agent.name}</p>\n                            <p className=\"text-sm capitalize truncate\" >{translateStatus(agent.status)}</p>\n                        </div>\n                    </div>\n                </DropdownMenuTrigger>\n                <DropdownMenuContent className=\"w-64\" side=\"top\" align=\"start\">\n                    <DropdownMenuLabel>我的状态</DropdownMenuLabel>\n                    <DropdownMenuRadioGroup value={agent.status} onValueChange={handleStatusChange}>\n                        <DropdownMenuRadioItem value=\"online\"><Wifi className=\"mr-2 h-4 w-4 text-green-500\" />在线</DropdownMenuRadioItem>\n                        <DropdownMenuRadioItem value=\"busy\"><Bell className=\"mr-2 h-4 w-4 text-orange-500\" />忙碌</DropdownMenuRadioItem>\n                        <DropdownMenuRadioItem value=\"offline\"><Moon className=\"mr-2 h-4 w-4 text-gray-500\" />离线</DropdownMenuRadioItem>\n                    </DropdownMenuRadioGroup>\n                    <DropdownMenuSeparator />\n                    <DropdownMenuItem onSelect={() => setIsShareOpen(true)}>\n                        <Share2 className=\"mr-2 h-4 w-4\" />\n                        <span>分享聊天链接</span>\n                    </DropdownMenuItem>\n                    <DropdownMenuItem onSelect={() => setIsSettingsOpen(true)}>\n                        <Settings className=\"mr-2 h-4 w-4\" />\n                        <span>设置</span>\n                    </DropdownMenuItem>\n                    <DropdownMenuSeparator />\n                    <DropdownMenuItem onClick={logout}>\n                        <LogOut className=\"mr-2 h-4 w-4\" />\n                        <span>退出登录</span>\n                    </DropdownMenuItem>\n                </DropdownMenuContent>\n            </DropdownMenu>\n\n            <AgentSettingsDialog isOpen={isSettingsOpen} setIsOpen={setIsSettingsOpen} />\n            <ShareDialog isOpen={isShareOpen} setIsOpen={setIsShareOpen} />\n        </>\n    );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2680, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/alert-dialog.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAEA;AACA;AAEA;AACA;AANA;;;;;;AAQA,MAAM,cAAc,2KAAA,CAAA,OAAyB;AAE7C,MAAM,qBAAqB,2KAAA,CAAA,UAA4B;AAEvD,MAAM,oBAAoB,2KAAA,CAAA,SAA2B;AAErD,MAAM,mCAAqB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGxC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,2KAAA,CAAA,UAA4B;QAC3B,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,2JACA;QAED,GAAG,KAAK;QACT,KAAK;;;;;;AAGT,mBAAmB,WAAW,GAAG,2KAAA,CAAA,UAA4B,CAAC,WAAW;AAEzE,MAAM,mCAAqB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGxC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;;0BACC,8OAAC;;;;;0BACD,8OAAC,2KAAA,CAAA,UAA4B;gBAC3B,KAAK;gBACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,+fACA;gBAED,GAAG,KAAK;;;;;;;;;;;;AAIf,mBAAmB,WAAW,GAAG,2KAAA,CAAA,UAA4B,CAAC,WAAW;AAEzE,MAAM,oBAAoB,CAAC,EACzB,SAAS,EACT,GAAG,OACkC,iBACrC,8OAAC;QACC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,oDACA;QAED,GAAG,KAAK;;;;;;AAGb,kBAAkB,WAAW,GAAG;AAEhC,MAAM,oBAAoB,CAAC,EACzB,SAAS,EACT,GAAG,OACkC,iBACrC,8OAAC;QACC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,iEACA;QAED,GAAG,KAAK;;;;;;AAGb,kBAAkB,WAAW,GAAG;AAEhC,MAAM,iCAAmB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,2KAAA,CAAA,QAA0B;QACzB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,yBAAyB;QACtC,GAAG,KAAK;;;;;;AAGb,iBAAiB,WAAW,GAAG,2KAAA,CAAA,QAA0B,CAAC,WAAW;AAErE,MAAM,uCAAyB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG5C,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,2KAAA,CAAA,cAAgC;QAC/B,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,uBAAuB,WAAW,GAChC,2KAAA,CAAA,cAAgC,CAAC,WAAW;AAE9C,MAAM,kCAAoB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGvC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,2KAAA,CAAA,SAA2B;QAC1B,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,CAAA,GAAA,kIAAA,CAAA,iBAAc,AAAD,KAAK;QAC/B,GAAG,KAAK;;;;;;AAGb,kBAAkB,WAAW,GAAG,2KAAA,CAAA,SAA2B,CAAC,WAAW;AAEvE,MAAM,kCAAoB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGvC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,2KAAA,CAAA,SAA2B;QAC1B,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,CAAA,GAAA,kIAAA,CAAA,iBAAc,AAAD,EAAE;YAAE,SAAS;QAAU,IACpC,gBACA;QAED,GAAG,KAAK;;;;;;AAGb,kBAAkB,WAAW,GAAG,2KAAA,CAAA,SAA2B,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 2807, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/agent/CustomerList.tsx"],"sourcesContent":["\n\"use client\";\n\nimport { useAgentStore } from \"@/lib/stores/agentStore\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"../ui/avatar\";\nimport { cn } from \"@/lib/utils\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport { zhCN } from 'date-fns/locale';\nimport { Headset, User as UserIcon, Archive, Trash2, ArchiveRestore } from \"lucide-react\";\nimport { AgentProfile } from \"./AgentProfile\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle, AlertDialogTrigger } from \"../ui/alert-dialog\";\nimport { Button } from \"../ui/button\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nexport function CustomerList() {\n    const { sessions, customers, activeSessionId, setActiveSessionId, deleteCustomer, unarchiveSession } = useAgentStore();\n    const { toast } = useToast();\n\n    const handleDelete = (e: React.MouseEvent, customerId: string) => {\n        e.stopPropagation(); // Prevent session selection\n        deleteCustomer(customerId);\n        toast({ title: \"客户已删除\", description: \"该客户及其对话已被移除。\", variant: \"destructive\"});\n    }\n\n    const handleUnarchive = (e: React.MouseEvent, sessionId: string) => {\n        e.stopPropagation();\n        unarchiveSession(sessionId);\n        toast({ title: \"会话已恢复\", description: \"该会话已从归档中恢复。\"});\n    }\n    \n    const activeSessions = sessions.filter(s => s.status !== 'archived');\n    const archivedSessions = sessions.filter(s => s.status === 'archived');\n\n    const renderSessionList = (list: typeof sessions, isArchivedList = false) => {\n        if(list.length === 0) {\n            return (\n                <div className=\"flex-grow flex flex-col items-center justify-center text-muted-foreground text-center p-4\">\n                    <Archive className=\"h-12 w-12\" />\n                    <p className=\"mt-4 text-sm font-semibold\">{isArchivedList ? \"没有已归档的会话\" : \"没有待处理的会话\"}</p>\n                    <p className=\"text-xs\">{isArchivedList ? \"所有会话都在主列表中。\" : \"祝您有美好的一天！\"}</p>\n                </div>\n            )\n        }\n\n        return list.map(session => {\n            const customer = customers.find(c => c.id === session.customerId);\n            const lastMessage = session.messages[session.messages.length - 1];\n            if(!customer) return null;\n\n            return (\n                <div key={session.id} className=\"relative group\">\n                    <button \n                        onClick={() => setActiveSessionId(session.id)}\n                        className={cn(\n                            \"w-full text-left p-3 rounded-lg flex gap-3 items-center transition-colors\",\n                            activeSessionId === session.id ? \"bg-primary/10\" : \"hover:bg-muted/50\"\n                        )}\n                    >\n                        <Avatar className=\"h-12 w-12 border\">\n                            <AvatarImage src={customer.avatar} />\n                            <AvatarFallback><UserIcon /></AvatarFallback>\n                            {session.status === 'pending' && <div className=\"absolute bottom-0 right-0 h-3 w-3 bg-accent rounded-full border-2 border-background\" />}\n                        </Avatar>\n                        <div className=\"flex-1 overflow-hidden\">\n                            <div className=\"flex justify-between items-baseline\">\n                                <p className=\"font-semibold truncate\">{customer.name}</p>\n                                <p className=\"text-xs text-muted-foreground shrink-0\">\n                                    {formatDistanceToNow(new Date(lastMessage.timestamp), { addSuffix: true, locale: zhCN })}\n                                </p>\n                            </div>\n                            <p className=\"text-sm text-muted-foreground truncate\">\n                                {lastMessage.type === 'text' ? lastMessage.text : `[${lastMessage.file.name}]`}\n                            </p>\n                        </div>\n                    </button>\n                    <div className=\"absolute top-1/2 -translate-y-1/2 right-2 flex items-center opacity-0 group-hover:opacity-100 transition-opacity\">\n                         {isArchivedList ? (\n                             <Button \n                                variant=\"ghost\" \n                                size=\"icon\" \n                                className=\"h-8 w-8 text-muted-foreground rounded-full\"\n                                onClick={(e) => handleUnarchive(e, session.id)}\n                            >\n                                <ArchiveRestore className=\"h-5 w-5\" />\n                            </Button>\n                         ) : (\n                             <AlertDialog>\n                                <AlertDialogTrigger asChild>\n                                    <Button \n                                        variant=\"ghost\" \n                                        size=\"icon\" \n                                        className={cn(\n                                            \"h-8 w-8 text-muted-foreground rounded-full relative overflow-hidden\",\n                                            \"bg-no-repeat bg-[length:200%_100%] bg-[100%_0]\",\n                                            \"hover:text-white transition-all duration-300\",\n                                            \"hover:bg-[0%_0%] hover:bg-destructive/80\"\n                                          )}\n                                    >\n                                        <Trash2 className=\"h-5 w-5\" />\n                                    </Button>\n                                </AlertDialogTrigger>\n                                <AlertDialogContent>\n                                    <AlertDialogHeader>\n                                        <AlertDialogTitle>您确定要删除该客户吗？</AlertDialogTitle>\n                                        <AlertDialogDescription>\n                                            此操作无法撤销。这将会永久删除该客户及其所有对话历史。\n                                        </AlertDialogDescription>\n                                    </AlertDialogHeader>\n                                    <AlertDialogFooter>\n                                        <AlertDialogCancel>取消</AlertDialogCancel>\n                                        <AlertDialogAction onClick={(e) => handleDelete(e, customer.id)} className=\"bg-destructive hover:bg-destructive/90\">\n                                            删除\n                                        </AlertDialogAction>\n                                    </AlertDialogFooter>\n                                </AlertDialogContent>\n                            </AlertDialog>\n                         )}\n                    </div>\n                </div>\n            )\n        })\n    }\n    \n    return (\n        <aside className=\"w-80 border-r bg-muted/20 flex flex-col h-full\">\n            <Tabs defaultValue=\"conversations\" className=\"flex-1 flex flex-col min-h-0\">\n                 <div className=\"p-3 border-b flex-shrink-0\">\n                    <div className=\"flex items-center gap-3\">\n                        <div className=\"flex h-10 w-10 items-center justify-center rounded-lg bg-primary text-primary-foreground shrink-0\">\n                            <Headset size={24} />\n                        </div>\n                        <TabsList className=\"grid w-full grid-cols-2 h-10\">\n                            <TabsTrigger value=\"conversations\">会话</TabsTrigger>\n                            <TabsTrigger value=\"archived\">归档</TabsTrigger>\n                        </TabsList>\n                    </div>\n                </div>\n                \n                <TabsContent value=\"conversations\" className=\"flex-1 min-h-0 flex flex-col\">\n                    <div className=\"flex-grow overflow-y-auto\">\n                        <div className=\"p-2 space-y-1\">\n                          {renderSessionList(activeSessions)}\n                        </div>\n                    </div>\n                </TabsContent>\n\n                <TabsContent value=\"archived\" className=\"flex-1 min-h-0 flex flex-col\">\n                     <div className=\"flex-grow overflow-y-auto\">\n                        <div className=\"p-2 space-y-1\">\n                          {renderSessionList(archivedSessions, true)}\n                        </div>\n                    </div>\n                </TabsContent>\n            </Tabs>\n            \n            <div className=\"p-2 border-t mt-auto flex-shrink-0\">\n                <AgentProfile />\n            </div>\n        </aside>\n    );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3247, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/scroll-area.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,8OAAC,0KAAA,CAAA,OAAwB;QACvB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,4BAA4B;QACzC,GAAG,KAAK;;0BAET,8OAAC,0KAAA,CAAA,WAA4B;gBAAC,WAAU;0BACrC;;;;;;0BAEH,8OAAC;;;;;0BACD,8OAAC,0KAAA,CAAA,SAA0B;;;;;;;;;;;AAG/B,WAAW,WAAW,GAAG,0KAAA,CAAA,OAAwB,CAAC,WAAW;AAE7D,MAAM,0BAAY,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG/B,CAAC,EAAE,SAAS,EAAE,cAAc,UAAU,EAAE,GAAG,OAAO,EAAE,oBACpD,8OAAC,0KAAA,CAAA,sBAAuC;QACtC,KAAK;QACL,aAAa;QACb,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,iDACA,gBAAgB,cACd,sDACF,gBAAgB,gBACd,wDACF;QAED,GAAG,KAAK;kBAET,cAAA,8OAAC,0KAAA,CAAA,kBAAmC;YAAC,WAAU;;;;;;;;;;;AAGnD,UAAU,WAAW,GAAG,0KAAA,CAAA,sBAAuC,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 3315, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/ai/flows/redact-pii.ts"],"sourcesContent":["'use server';\n\n/**\n * @fileOverview Redacts PII from customer messages using an AI model.\n *\n * - redactPii - A function that redacts PII from customer messages.\n * - RedactPiiInput - The input type for the redactPii function.\n * - RedactPiiOutput - The return type for the redactPii function.\n */\n\nimport {ai} from '@/ai/genkit';\nimport {z} from 'genkit';\n\nconst RedactPiiInputSchema = z.object({\n  message: z.string().describe('The customer message to redact PII from.'),\n});\nexport type RedactPiiInput = z.infer<typeof RedactPiiInputSchema>;\n\nconst RedactPiiOutputSchema = z.object({\n  redactedMessage: z.string().describe('The message with PII redacted.'),\n});\nexport type RedactPiiOutput = z.infer<typeof RedactPiiOutputSchema>;\n\nexport async function redactPii(input: RedactPiiInput): Promise<RedactPiiOutput> {\n  return redactPiiFlow(input);\n}\n\nconst redactPiiPrompt = ai.definePrompt({\n  name: 'redactPiiPrompt',\n  input: {schema: RedactPiiInputSchema},\n  output: {schema: RedactPiiOutputSchema},\n  prompt: `You are an AI assistant specializing in redacting personally identifiable information (PII) from customer messages.\n\n  Your task is to analyze the given message and redact any PII, such as names, email addresses, phone numbers, social security numbers, credit card numbers, addresses, and other sensitive information.\n  Replace the PII with a placeholder like \"[REDACTED]\" or a similar marker.\n\n  Message: {{{message}}}\n  `,\n});\n\nconst redactPiiFlow = ai.defineFlow(\n  {\n    name: 'redactPiiFlow',\n    inputSchema: RedactPiiInputSchema,\n    outputSchema: RedactPiiOutputSchema,\n  },\n  async input => {\n    const {output} = await redactPiiPrompt(input);\n    return output!;\n  }\n);\n"],"names":[],"mappings":";;;;;;IAuBsB,YAAA,WAAA,GAAA,CAAA,GAAA,sNAAA,CAAA,wBAAA,EAAA,8CAAA,sNAAA,CAAA,aAAA,EAAA,KAAA,GAAA,sNAAA,CAAA,mBAAA,EAAA","debugId":null}},
    {"offset": {"line": 3328, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/popover.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n"],"names":[],"mappings":";;;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,UAAU,mKAAA,CAAA,OAAqB;AAErC,MAAM,iBAAiB,mKAAA,CAAA,UAAwB;AAE/C,MAAM,+BAAiB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGpC,CAAC,EAAE,SAAS,EAAE,QAAQ,QAAQ,EAAE,aAAa,CAAC,EAAE,GAAG,OAAO,EAAE,oBAC5D,8OAAC,mKAAA,CAAA,SAAuB;kBACtB,cAAA,8OAAC,mKAAA,CAAA,UAAwB;YACvB,KAAK;YACL,OAAO;YACP,YAAY;YACZ,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,8aACA;YAED,GAAG,KAAK;;;;;;;;;;;AAIf,eAAe,WAAW,GAAG,mKAAA,CAAA,UAAwB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 3369, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/shared/CircularProgress.tsx"],"sourcesContent":["\nimport React from 'react';\nimport { cn } from \"@/lib/utils\";\nimport { ArrowDown, Check } from \"lucide-react\";\n\ninterface CircularProgressProps {\n    progress: number;\n    size?: number;\n    strokeWidth?: number;\n    className?: string;\n}\n\nexport const CircularProgress: React.FC<CircularProgressProps> = ({\n    progress,\n    size = 40,\n    strokeWidth = 4,\n    className\n}) => {\n    const radius = (size - strokeWidth) / 2;\n    const circumference = 2 * Math.PI * radius;\n    const offset = circumference - (progress / 100) * circumference;\n\n    const isCompleted = progress >= 100;\n\n    return (\n        <div className={cn(\"relative flex items-center justify-center\", className)} style={{ width: size, height: size }}>\n            <svg width={size} height={size} viewBox={`0 0 ${size} ${size}`} className=\"transform -rotate-90\">\n                <circle\n                    className=\"text-muted\"\n                    stroke=\"currentColor\"\n                    strokeWidth={strokeWidth}\n                    fill=\"transparent\"\n                    r={radius}\n                    cx={size / 2}\n                    cy={size / 2}\n                />\n                <circle\n                    className=\"text-primary\"\n                    stroke=\"currentColor\"\n                    strokeWidth={strokeWidth}\n                    strokeDasharray={circumference}\n                    strokeDashoffset={offset}\n                    strokeLinecap=\"round\"\n                    fill=\"transparent\"\n                    r={radius}\n                    cx={size / 2}\n                    cy={size / 2}\n                    style={{ transition: 'stroke-dashoffset 0.3s ease-in-out' }}\n                />\n            </svg>\n            <div className=\"absolute\">\n                {isCompleted ? (\n                    <Check className=\"h-5 w-5 text-primary\" />\n                ) : (\n                    <ArrowDown className=\"h-5 w-5 text-muted-foreground\" />\n                )}\n            </div>\n        </div>\n    );\n};\n"],"names":[],"mappings":";;;;AAEA;AACA;AAAA;;;;AASO,MAAM,mBAAoD,CAAC,EAC9D,QAAQ,EACR,OAAO,EAAE,EACT,cAAc,CAAC,EACf,SAAS,EACZ;IACG,MAAM,SAAS,CAAC,OAAO,WAAW,IAAI;IACtC,MAAM,gBAAgB,IAAI,KAAK,EAAE,GAAG;IACpC,MAAM,SAAS,gBAAgB,AAAC,WAAW,MAAO;IAElD,MAAM,cAAc,YAAY;IAEhC,qBACI,8OAAC;QAAI,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,6CAA6C;QAAY,OAAO;YAAE,OAAO;YAAM,QAAQ;QAAK;;0BAC3G,8OAAC;gBAAI,OAAO;gBAAM,QAAQ;gBAAM,SAAS,CAAC,IAAI,EAAE,KAAK,CAAC,EAAE,MAAM;gBAAE,WAAU;;kCACtE,8OAAC;wBACG,WAAU;wBACV,QAAO;wBACP,aAAa;wBACb,MAAK;wBACL,GAAG;wBACH,IAAI,OAAO;wBACX,IAAI,OAAO;;;;;;kCAEf,8OAAC;wBACG,WAAU;wBACV,QAAO;wBACP,aAAa;wBACb,iBAAiB;wBACjB,kBAAkB;wBAClB,eAAc;wBACd,MAAK;wBACL,GAAG;wBACH,IAAI,OAAO;wBACX,IAAI,OAAO;wBACX,OAAO;4BAAE,YAAY;wBAAqC;;;;;;;;;;;;0BAGlE,8OAAC;gBAAI,WAAU;0BACV,4BACG,8OAAC,oMAAA,CAAA,QAAK;oBAAC,WAAU;;;;;yCAEjB,8OAAC,gNAAA,CAAA,YAAS;oBAAC,WAAU;;;;;;;;;;;;;;;;;AAKzC","debugId":null}},
    {"offset": {"line": 3468, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/sheet.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;AAEA;AACA;AACA;AACA;AAEA;AAPA;;;;;;;AASA,MAAM,QAAQ,kKAAA,CAAA,OAAmB;AAEjC,MAAM,eAAe,kKAAA,CAAA,UAAsB;AAE3C,MAAM,aAAa,kKAAA,CAAA,QAAoB;AAEvC,MAAM,cAAc,kKAAA,CAAA,SAAqB;AAEzC,MAAM,6BAAe,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,kKAAA,CAAA,UAAsB;QACrB,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,2JACA;QAED,GAAG,KAAK;QACT,KAAK;;;;;;AAGT,aAAa,WAAW,GAAG,kKAAA,CAAA,UAAsB,CAAC,WAAW;AAE7D,MAAM,gBAAgB,CAAA,GAAA,gKAAA,CAAA,MAAG,AAAD,EACtB,oMACA;IACE,UAAU;QACR,MAAM;YACJ,KAAK;YACL,QACE;YACF,MAAM;YACN,OACE;QACJ;IACF;IACA,iBAAiB;QACf,MAAM;IACR;AACF;AAOF,MAAM,6BAAe,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGlC,CAAC,EAAE,OAAO,OAAO,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpD,8OAAC;;0BACC,8OAAC;;;;;0BACD,8OAAC,kKAAA,CAAA,UAAsB;gBACrB,KAAK;gBACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,cAAc;oBAAE;gBAAK,IAAI;gBACtC,GAAG,KAAK;;oBAER;kCACD,8OAAC,kKAAA,CAAA,QAAoB;wBAAC,WAAU;;0CAC9B,8OAAC,4LAAA,CAAA,IAAC;gCAAC,WAAU;;;;;;0CACb,8OAAC;gCAAK,WAAU;0CAAU;;;;;;;;;;;;;;;;;;;;;;;;AAKlC,aAAa,WAAW,GAAG,kKAAA,CAAA,UAAsB,CAAC,WAAW;AAE7D,MAAM,cAAc,CAAC,EACnB,SAAS,EACT,GAAG,OACkC,iBACrC,8OAAC;QACC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,oDACA;QAED,GAAG,KAAK;;;;;;AAGb,YAAY,WAAW,GAAG;AAE1B,MAAM,cAAc,CAAC,EACnB,SAAS,EACT,GAAG,OACkC,iBACrC,8OAAC;QACC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,iEACA;QAED,GAAG,KAAK;;;;;;AAGb,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,kKAAA,CAAA,QAAoB;QACnB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,yCAAyC;QACtD,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG,kKAAA,CAAA,QAAoB,CAAC,WAAW;AAEzD,MAAM,iCAAmB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,kKAAA,CAAA,cAA0B;QACzB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,iBAAiB,WAAW,GAAG,kKAAA,CAAA,cAA0B,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 3617, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n"],"names":[],"mappings":";;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,qBAAO,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG1B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,4DACA;QAED,GAAG,KAAK;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,sDACA;QAED,GAAG,KAAK;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGrC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QAAI,KAAK;QAAK,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,YAAY;QAAa,GAAG,KAAK;;;;;;AAEhE,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 3698, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/agent/QuickReplies.tsx"],"sourcesContent":["\n\"use client\";\n\nimport { useAgentStore } from \"@/lib/stores/agentStore\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"../ui/card\";\nimport { MessageSquareQuote, Send } from \"lucide-react\";\nimport { ScrollArea } from \"../ui/scroll-area\";\nimport { Button } from \"../ui/button\";\n\nexport function QuickReplies() {\n    const { settings, sendMessage, activeSessionId } = useAgentStore();\n\n    if (!settings) return null;\n\n    const { quickReplies } = settings;\n    \n    const handleSendReply = (message: string) => {\n        if(activeSessionId) {\n            sendMessage(activeSessionId, {type: 'text', text: message});\n        }\n    }\n\n    return (\n        <div className=\"h-full flex flex-col\">\n           \n            <div className=\"flex-1 p-0\">\n                <ScrollArea className=\"h-full\">\n                    <div className=\"space-y-2\">\n                        {quickReplies.length > 0 ? (\n                            <div className=\"space-y-2\">\n                                {quickReplies.map((reply) => (\n                                    <div key={reply.id} className=\"p-3 bg-background rounded-md border text-sm group relative\">\n                                        <code className=\"font-medium text-primary bg-primary/10 px-1.5 py-0.5 rounded\">{reply.shortcut}</code>\n                                        <p className=\"text-muted-foreground pr-8 mt-1\">{reply.message}</p>\n                                        <Button \n                                            variant=\"ghost\" \n                                            size=\"icon\" \n                                            className=\"absolute top-1/2 right-2 -translate-y-1/2 h-8 w-8 text-muted-foreground opacity-0 group-hover:opacity-100\"\n                                            onClick={() => handleSendReply(reply.message)}\n                                            disabled={!activeSessionId}\n                                        >\n                                            <Send className=\"h-4 w-4\" />\n                                        </Button>\n                                    </div>\n                                ))}\n                            </div>\n                        ) : (\n                             <div className=\"text-center text-muted-foreground py-10\">\n                                <MessageSquareQuote className=\"h-10 w-10 mx-auto mb-2\" />\n                                <p className=\"text-sm\">没有可用的快捷回复。</p>\n                                <p className=\"text-xs\">您可以在设置中添加。</p>\n                            </div>\n                        )}\n                    </div>\n                </ScrollArea>\n            </div>\n        </div>\n    );\n}\n\n    "],"names":[],"mappings":";;;;AAGA;AAEA;AAAA;AACA;AACA;AANA;;;;;;AAQO,SAAS;IACZ,MAAM,EAAE,QAAQ,EAAE,WAAW,EAAE,eAAe,EAAE,GAAG,CAAA,GAAA,kIAAA,CAAA,gBAAa,AAAD;IAE/D,IAAI,CAAC,UAAU,OAAO;IAEtB,MAAM,EAAE,YAAY,EAAE,GAAG;IAEzB,MAAM,kBAAkB,CAAC;QACrB,IAAG,iBAAiB;YAChB,YAAY,iBAAiB;gBAAC,MAAM;gBAAQ,MAAM;YAAO;QAC7D;IACJ;IAEA,qBACI,8OAAC;QAAI,WAAU;kBAEX,cAAA,8OAAC;YAAI,WAAU;sBACX,cAAA,8OAAC,0IAAA,CAAA,aAAU;gBAAC,WAAU;0BAClB,cAAA,8OAAC;oBAAI,WAAU;8BACV,aAAa,MAAM,GAAG,kBACnB,8OAAC;wBAAI,WAAU;kCACV,aAAa,GAAG,CAAC,CAAC,sBACf,8OAAC;gCAAmB,WAAU;;kDAC1B,8OAAC;wCAAK,WAAU;kDAAgE,MAAM,QAAQ;;;;;;kDAC9F,8OAAC;wCAAE,WAAU;kDAAmC,MAAM,OAAO;;;;;;kDAC7D,8OAAC,kIAAA,CAAA,SAAM;wCACH,SAAQ;wCACR,MAAK;wCACL,WAAU;wCACV,SAAS,IAAM,gBAAgB,MAAM,OAAO;wCAC5C,UAAU,CAAC;kDAEX,cAAA,8OAAC,kMAAA,CAAA,OAAI;4CAAC,WAAU;;;;;;;;;;;;+BAVd,MAAM,EAAE;;;;;;;;;6CAgBzB,8OAAC;wBAAI,WAAU;;0CACZ,8OAAC,sOAAA,CAAA,qBAAkB;gCAAC,WAAU;;;;;;0CAC9B,8OAAC;gCAAE,WAAU;0CAAU;;;;;;0CACvB,8OAAC;gCAAE,WAAU;0CAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQvD","debugId":null}},
    {"offset": {"line": 3841, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/agent/ChatWindow.tsx"],"sourcesContent":["\n\"use client\";\n\nimport { useEffect, useRef, useState } from \"react\";\nimport type { ChatSession, ChatMessage, FileChatMessage, TextChatMessage, Customer } from \"@/lib/types\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"../ui/avatar\";\nimport { Button } from \"../ui/button\";\nimport { Textarea } from \"../ui/textarea\";\nimport { Send, Sparkles, Loader2, User as UserIcon, Smile, Mic, Paperclip, Image as ImageIcon, Ban, Dot, Folder, Globe, HardDrive, MapPin, Calendar, CheckCircle, Archive, ArchiveRestore } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { useAgentStore } from \"@/lib/stores/agentStore\";\nimport { format, formatDistanceToNow } from \"date-fns\";\nimport { zhCN } from \"date-fns/locale\";\nimport { ScrollArea } from \"../ui/scroll-area\";\nimport { redactPii } from \"@/ai/flows/redact-pii\";\nimport { Popover, PopoverContent, PopoverTrigger } from \"../ui/popover\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { CircularProgress } from \"../shared/CircularProgress\";\nimport { Sheet, SheetContent, SheetDescription, SheetHeader, SheetTitle, SheetTrigger } from \"../ui/sheet\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"../ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"../ui/tabs\";\nimport { QuickReplies } from \"./QuickReplies\";\n\ninterface ChatWindowProps {\n    session: ChatSession;\n    customer: Customer;\n}\n\nconst EMOJIS = [\n    '😀', '😂', '😊', '😍', '🤔', '😢', '😠', '😮',\n    '👍', '👎', '❤️', '💔', '🎉', '🔥', '🙏', '🙌',\n    '👏', '💪', '💯', '✨', '✅', '❌', '❓', '💡'\n];\n\nexport function ChatWindow({ session, customer }: ChatWindowProps) {\n    const { agent, sendMessage, settings, sendFileMessage, blockCustomer, unblockCustomer, archiveSession } = useAgentStore();\n    const [message, setMessage] = useState(\"\");\n    const [isRedacting, setIsRedacting] = useState(false);\n    const [isRecording, setIsRecording] = useState(false);\n    const scrollAreaRef = useRef<HTMLDivElement>(null);\n    const fileInputRef = useRef<HTMLInputElement>(null);\n    const imageInputRef = useRef<HTMLInputElement>(null);\n    const { toast } = useToast();\n\n    const isCustomerBlocked = customer?.ipAddress ? settings?.blockedIps.includes(customer.ipAddress) : false;\n    const isArchived = session?.status === 'archived';\n\n    const customerDetails = [\n        { icon: Globe, label: \"IP 地址\", value: customer.ipAddress },\n        { icon: HardDrive, label: \"设备\", value: customer.device },\n        { icon: MapPin, label: \"位置\", value: customer.location },\n        { icon: Calendar, label: \"首次访问\", value: format(new Date(customer.firstSeen), \"PPP\", { locale: zhCN }) },\n    ];\n    \n    useEffect(() => {\n        if (scrollAreaRef.current) {\n            scrollAreaRef.current.scrollTo({\n                top: scrollAreaRef.current.scrollHeight,\n                behavior: 'smooth'\n            });\n        }\n    }, [session.messages]);\n\n    const handleSend = async () => {\n        if (!message.trim() || isCustomerBlocked) return;\n        \n        const textMessage: Omit<TextChatMessage, 'id' | 'timestamp' | 'sender' | 'agentId'> = {\n            type: 'text',\n            text: message,\n        };\n\n        await sendMessage(session.id, textMessage);\n        setMessage(\"\");\n    };\n    \n    const handleRedact = async () => {\n        if (!message.trim()) return;\n        setIsRedacting(true);\n        try {\n            const result = await redactPii({ message });\n            setMessage(result.redactedMessage);\n        } catch (error) {\n            console.error(\"Failed to redact message:\", error);\n            toast({ title: \"处理失败\", description: \"无法处理您的消息。\", variant: \"destructive\" });\n        } finally {\n            setIsRedacting(false);\n        }\n    };\n    \n    const handleEmojiSelect = (emoji: string) => {\n        setMessage(prev => prev + emoji);\n    }\n    \n    const handleAttachmentClick = (type: 'file' | 'image') => {\n        if (type === 'file') {\n            fileInputRef.current?.click();\n        } else {\n            imageInputRef.current?.click();\n        }\n    }\n    \n    const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const file = e.target.files?.[0];\n        if (file && agent) {\n            sendFileMessage(session.id, file);\n        }\n        e.target.value = \"\";\n    }\n    \n    const toggleRecording = () => {\n        setIsRecording(!isRecording);\n        toast({\n            title: isRecording ? \"录音已停止\" : \"开始录音...\",\n            description: \"语音输入功能正在开发中。\"\n        });\n    }\n    \n    const formatFileSize = (bytes: number) => {\n        if (bytes === 0) return '0 Bytes';\n        const k = 1024;\n        const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n        const i = Math.floor(Math.log(bytes) / Math.log(k));\n        return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n    }\n    \n     const handleToggleBlock = () => {\n        if (!customer.ipAddress) {\n            toast({ title: \"操作失败\", description: \"该客户没有IP地址，无法拉黑。\", variant: \"destructive\" });\n            return;\n        }\n        if (isCustomerBlocked) {\n            unblockCustomer(customer.ipAddress);\n            toast({ title: \"客户已解除拉黑\" });\n        } else {\n            blockCustomer(customer.ipAddress);\n            toast({ title: \"客户已被拉黑\", description: \"您将不会再收到该IP地址的消息。\" });\n        }\n    };\n    \n    const handleArchive = () => {\n        if (!session.id) return;\n        archiveSession(session.id);\n        toast({ title: \"会话已归档\" });\n    }\n\n    if (!customer || !agent) return null;\n\n    return (\n       <main className=\"flex flex-1\">\n            <div className=\"flex-1 flex flex-col h-full bg-background\">\n                <header className=\"p-4 border-b flex items-center justify-between gap-4\">\n                    <div className=\"flex items-center gap-4\">\n                        <Avatar>\n                            <AvatarImage src={customer.avatar} />\n                            <AvatarFallback><UserIcon/></AvatarFallback>\n                        </Avatar>\n                        <div>\n                            <h2 className=\"font-semibold text-lg\">{customer.name}</h2>\n                            <p className=\"text-xs text-muted-foreground\">会话开始于: {format(new Date(session.createdAt), \"PPP HH:mm\", { locale: zhCN })}</p>\n                        </div>\n                    </div>\n                    <Sheet>\n                        <SheetTrigger asChild>\n                             <Button variant=\"ghost\" size=\"icon\">\n                                <UserIcon className=\"h-5 w-5 text-muted-foreground\" />\n                             </Button>\n                        </SheetTrigger>\n                        <SheetContent className=\"w-[400px] sm:w-[540px] p-0 flex flex-col\">\n                           <SheetHeader className=\"p-6 pb-0\">\n                                <SheetTitle>客户详情</SheetTitle>\n                                <SheetDescription>\n                                    查看客户信息，使用快捷回复，或执行操作。\n                                </SheetDescription>\n                           </SheetHeader>\n                           <aside className=\"p-6 flex flex-col gap-6 h-full overflow-y-auto\">\n                                {isArchived && (\n                                    <div className=\"absolute inset-0 bg-background/80 z-10 flex flex-col items-center justify-center text-center p-4\">\n                                        <Archive className=\"h-10 w-10 text-muted-foreground mb-4\" />\n                                        <p className=\"font-semibold text-lg\">会话已归档</p>\n                                        <p className=\"text-sm text-muted-foreground\">您可以从归档列表中恢复此会话。</p>\n                                    </div>\n                                )}\n                                <div className=\"text-center flex flex-col items-center flex-shrink-0\">\n                                    <Avatar className=\"h-24 w-24 border-2 border-primary mb-4\">\n                                        <AvatarImage src={customer.avatar} />\n                                        <AvatarFallback>{customer.name[0]}</AvatarFallback>\n                                    </Avatar>\n                                    <h2 className=\"text-xl font-bold\">{customer.name}</h2>\n                                </div>\n                                <Tabs defaultValue=\"info\" className=\"flex-1 flex flex-col min-h-0\">\n                                    <TabsList className=\"grid w-full grid-cols-2\">\n                                        <TabsTrigger value=\"info\">客户信息</TabsTrigger>\n                                        <TabsTrigger value=\"replies\">快捷回复</TabsTrigger>\n                                    </TabsList>\n                                    <TabsContent value=\"info\" className=\"flex-1 mt-4 min-h-0\">\n                                        <ScrollArea className=\"h-full\">\n                                            <div className=\"flex flex-col gap-6 pr-4\">\n                                                <Card>\n                                                    <CardHeader>\n                                                        <CardTitle className=\"text-base\">客户信息</CardTitle>\n                                                    </CardHeader>\n                                                    <CardContent className=\"space-y-4\">\n                                                        {customerDetails.map(detail => (\n                                                            <div key={detail.label} className=\"flex items-start gap-3 text-sm\">\n                                                                <detail.icon className=\"h-4 w-4 mt-0.5 text-muted-foreground\" />\n                                                                <div>\n                                                                    <p className=\"text-muted-foreground\">{detail.label}</p>\n                                                                    <p className=\"font-medium\">{detail.value}</p>\n                                                                </div>\n                                                            </div>\n                                                        ))}\n                                                    </CardContent>\n                                                </Card>\n                                                <Card>\n                                                    <CardHeader>\n                                                        <CardTitle className=\"text-base\">会话历史</CardTitle>\n                                                    </CardHeader>\n                                                    <CardContent>\n                                                        <p className=\"text-xs text-muted-foreground text-center\">没有与该客户的过往会话。</p>\n                                                    </CardContent>\n                                                </Card>\n                                            </div>\n                                        </ScrollArea>\n                                    </TabsContent>\n                                    <TabsContent value=\"replies\" className=\"flex-1 mt-4 min-h-0\">\n                                        <QuickReplies />\n                                    </TabsContent>\n                                </Tabs>\n\n                                <div className=\"flex-shrink-0 flex items-center gap-2\">\n                                    <Button \n                                        variant=\"outline\" \n                                        className={cn(\n                                            \"flex-1\", \n                                            isCustomerBlocked && \"bg-yellow-400 hover:bg-yellow-500 text-black\"\n                                        )}\n                                        onClick={handleToggleBlock}\n                                        disabled={!customer.ipAddress}\n                                    >\n                                        {isCustomerBlocked ? <CheckCircle className=\"mr-2\" /> : <Ban className=\"mr-2\" />}\n                                        {isCustomerBlocked ? '解除' : '拉黑'}\n                                    </Button>\n                                    \n                                    <Button variant=\"outline\" className=\"flex-1\" onClick={handleArchive}>\n                                        <Archive className=\"mr-2\" />\n                                        归档\n                                    </Button>\n                                </div>\n                           </aside>\n                        </SheetContent>\n                    </Sheet>\n                </header>\n\n                <ScrollArea className=\"flex-1\" ref={scrollAreaRef}>\n                    <div className=\"p-6 space-y-6\">\n                        {session.messages.map((msg) => (\n                            <div key={msg.id} className={cn(\"flex items-end gap-3\", msg.sender === 'agent' && \"justify-end\")}>\n                            {msg.sender === 'customer' && (\n                                    <Avatar className=\"h-8 w-8\">\n                                        <AvatarImage src={customer.avatar} />\n                                        <AvatarFallback><UserIcon /></AvatarFallback>\n                                    </Avatar>\n                            )}\n                            <div className={cn(\n                                    \"max-w-md p-3 rounded-2xl\", \n                                    msg.sender === 'agent' ? 'bg-primary text-primary-foreground rounded-br-none' : 'bg-muted rounded-bl-none'\n                                )}>\n                                    {msg.type === 'text' ? (\n                                        <p className=\"text-sm\">{msg.text}</p>\n                                    ) : (\n                                        <a href={(msg as FileChatMessage).file.url} target=\"_blank\" rel=\"noopener noreferrer\" className=\"flex items-center gap-3\">\n                                            <CircularProgress progress={(msg as FileChatMessage).file.progress} />\n                                            <div>\n                                                <p className=\"text-sm font-medium break-all underline\">{(msg as FileChatMessage).file.name}</p>\n                                                <p className={cn(\"text-xs\", msg.sender === 'agent' ? 'text-primary-foreground/80' : 'text-muted-foreground')}>\n                                                    {formatFileSize((msg as FileChatMessage).file.size)}\n                                                </p>\n                                            </div>\n                                        </a>\n                                    )}\n                                    <p className={cn(\"text-xs mt-1 text-right\", msg.sender === 'agent' ? 'text-primary-foreground/70' : 'text-muted-foreground/70')}>\n                                        {format(new Date(msg.timestamp), 'HH:mm', { locale: zhCN })}\n                                    </p>\n                            </div>\n                                {msg.sender === 'agent' && (\n                                    <Avatar className=\"h-8 w-8\">\n                                        <AvatarImage src={agent.avatar} />\n                                        <AvatarFallback>{agent.name[0]}</AvatarFallback>\n                                    </Avatar>\n                            )}\n                            </div>\n                        ))}\n                    </div>\n                </ScrollArea>\n\n                <footer className=\"p-4 border-t\">\n                    <div className=\"relative\">\n                        {isCustomerBlocked && (\n                            <div className=\"absolute inset-0 bg-background/80 z-10 flex flex-col items-center justify-center rounded-lg\">\n                                <Ban className=\"h-8 w-8 text-destructive mb-2\" />\n                                <p className=\"font-semibold\">用户已被拉黑</p>\n                                <p className=\"text-sm text-muted-foreground\">您无法向该用户发送消息。</p>\n                            </div>\n                        )}\n                        <div className=\"space-y-2\">\n                            <div className=\"flex items-center gap-2\">\n                                <Popover>\n                                    <PopoverTrigger asChild>\n                                        <Button variant=\"ghost\" size=\"icon\" className=\"text-muted-foreground\">\n                                            <Smile />\n                                        </Button>\n                                    </PopoverTrigger>\n                                    <PopoverContent className=\"w-auto p-2\">\n                                        <div className=\"grid grid-cols-6 gap-2\">\n                                            {EMOJIS.map(emoji => (\n                                                <Button key={emoji} variant=\"ghost\" size=\"icon\" onClick={() => handleEmojiSelect(emoji)}>{emoji}</Button>\n                                            ))}\n                                        </div>\n                                    </PopoverContent>\n                                </Popover>\n                                <Button variant=\"ghost\" size=\"icon\" className={cn(\"text-muted-foreground\", isRecording && \"text-red-500 bg-red-500/10\")} onClick={toggleRecording}>\n                                    <Mic />\n                                    {isRecording && <Dot className=\"absolute -top-1 -right-1 text-red-500 animate-ping\" />}\n                                </Button>\n                                <Button variant=\"ghost\" size=\"icon\" className=\"text-muted-foreground\" onClick={() => handleAttachmentClick('file')}>\n                                    <Paperclip />\n                                </Button>\n                                <Button variant=\"ghost\" size=\"icon\" className=\"text-muted-foreground\" onClick={() => handleAttachmentClick('image')}>\n                                    <ImageIcon />\n                                </Button>\n                                <input type=\"file\" ref={fileInputRef} onChange={handleFileChange} className=\"hidden\" />\n                                <input type=\"file\" accept=\"image/*\" ref={imageInputRef} onChange={handleFileChange} className=\"hidden\" />\n                            </div>\n                            <div className=\"relative\">\n                                <Textarea \n                                    placeholder=\"输入您的消息...\" \n                                    className=\"pr-32\"\n                                    rows={4}\n                                    value={message}\n                                    onChange={(e) => setMessage(e.target.value)}\n                                    onKeyDown={(e) => {\n                                        if (e.key === 'Enter' && !e.shiftKey) {\n                                            e.preventDefault();\n                                            handleSend();\n                                        }\n                                    }}\n                                    disabled={isCustomerBlocked}\n                                />\n                                <div className=\"absolute right-3 top-1/2 -translate-y-1/2 flex items-center gap-2\">\n                                    <Button variant=\"ghost\" size=\"icon\" onClick={handleRedact} disabled={isRedacting || !message || isCustomerBlocked}>\n                                        {isRedacting ? <Loader2 className=\"h-5 w-5 animate-spin\" /> : <Sparkles className=\"h-5 w-5 text-muted-foreground\" />}\n                                    </Button>\n                                    <Button onClick={handleSend} disabled={!message || isCustomerBlocked}>\n                                        <Send className=\"h-4 w-4 mr-2\" />\n                                        发送\n                                    </Button>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </footer>\n            </div>\n       </main>\n    );\n}\n\n    \n\n    "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4947, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/skeleton.tsx"],"sourcesContent":["import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n"],"names":[],"mappings":";;;;AAAA;;;AAEA,SAAS,SAAS,EAChB,SAAS,EACT,GAAG,OACkC;IACrC,qBACE,8OAAC;QACC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,qCAAqC;QAClD,GAAG,KAAK;;;;;;AAGf","debugId":null}},
    {"offset": {"line": 4971, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/agent/AgentUI.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect } from \"react\";\nimport { useAgentStore } from \"@/lib/stores/agentStore\";\nimport { useAuthStore } from \"@/lib/stores/authStore\";\nimport { CustomerList } from \"./CustomerList\";\nimport { ChatWindow } from \"./ChatWindow\";\nimport { Skeleton } from \"../ui/skeleton\";\nimport { MessageCircle } from \"lucide-react\";\n\nexport function AgentUI() {\n    const { user } = useAuthStore();\n    const { fetchAgentData, isLoading, activeSessionId, sessions, customers, agent } = useAgentStore();\n\n    useEffect(() => {\n        if(user?.role === 'agent') {\n            fetchAgentData(user.id);\n        }\n    }, [user, fetchAgentData]);\n    \n    if (isLoading && !agent) {\n        return <LoadingSkeleton />;\n    }\n\n    const activeSession = sessions.find(s => s.id === activeSessionId);\n    const activeCustomer = customers.find(c => c.id === activeSession?.customerId);\n\n    return (\n        <div className=\"flex h-full\">\n            <CustomerList />\n            {activeSession && activeCustomer ? (\n                <ChatWindow session={activeSession} customer={activeCustomer} />\n            ) : (\n                <div className=\"flex-1 flex flex-col items-center justify-center text-center text-muted-foreground bg-muted/30\">\n                    <MessageCircle size={48} className=\"mb-4\" />\n                    <h2 className=\"text-xl font-semibold\">无有效对话</h2>\n                    <p>从列表中选择一个对话开始。</p>\n                </div>\n            )}\n        </div>\n    );\n}\n\nfunction LoadingSkeleton() {\n    return (\n        <div className=\"flex h-full\">\n            <div className=\"w-80 border-r p-2 flex flex-col gap-2\">\n                <Skeleton className=\"h-10 w-full\" />\n                <Skeleton className=\"h-16 w-full\" />\n                <Skeleton className=\"h-16 w-full\" />\n                <Skeleton className=\"h-16 w-full opacity-50\" />\n                <Skeleton className=\"h-16 w-full opacity-50\" />\n            </div>\n            <div className=\"flex-1 flex flex-col\">\n                <div className=\"p-4 border-b\"><Skeleton className=\"h-8 w-48\" /></div>\n                <div className=\"flex-1 p-4 space-y-4\">\n                    <Skeleton className=\"h-12 w-3/4\" />\n                    <Skeleton className=\"h-12 w-1/2 ml-auto\" />\n                    <Skeleton className=\"h-16 w-2/3\" />\n                </div>\n                <div className=\"p-4 border-t\"><Skeleton className=\"h-20 w-full\" /></div>\n            </div>\n        </div>\n    )\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;;;;;;;;AAUO,SAAS;IACZ,MAAM,EAAE,IAAI,EAAE,GAAG,CAAA,GAAA,iIAAA,CAAA,eAAY,AAAD;IAC5B,MAAM,EAAE,cAAc,EAAE,SAAS,EAAE,eAAe,EAAE,QAAQ,EAAE,SAAS,EAAE,KAAK,EAAE,GAAG,CAAA,GAAA,kIAAA,CAAA,gBAAa,AAAD;IAE/F,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACN,IAAG,MAAM,SAAS,SAAS;YACvB,eAAe,KAAK,EAAE;QAC1B;IACJ,GAAG;QAAC;QAAM;KAAe;IAEzB,IAAI,aAAa,CAAC,OAAO;QACrB,qBAAO,8OAAC;;;;;IACZ;IAEA,MAAM,gBAAgB,SAAS,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;IAClD,MAAM,iBAAiB,UAAU,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,eAAe;IAEnE,qBACI,8OAAC;QAAI,WAAU;;0BACX,8OAAC,2IAAA,CAAA,eAAY;;;;;YACZ,iBAAiB,+BACd,8OAAC,yIAAA,CAAA,aAAU;gBAAC,SAAS;gBAAe,UAAU;;;;;qCAE9C,8OAAC;gBAAI,WAAU;;kCACX,8OAAC,wNAAA,CAAA,gBAAa;wBAAC,MAAM;wBAAI,WAAU;;;;;;kCACnC,8OAAC;wBAAG,WAAU;kCAAwB;;;;;;kCACtC,8OAAC;kCAAE;;;;;;;;;;;;;;;;;;AAKvB;AAEA,SAAS;IACL,qBACI,8OAAC;QAAI,WAAU;;0BACX,8OAAC;gBAAI,WAAU;;kCACX,8OAAC,oIAAA,CAAA,WAAQ;wBAAC,WAAU;;;;;;kCACpB,8OAAC,oIAAA,CAAA,WAAQ;wBAAC,WAAU;;;;;;kCACpB,8OAAC,oIAAA,CAAA,WAAQ;wBAAC,WAAU;;;;;;kCACpB,8OAAC,oIAAA,CAAA,WAAQ;wBAAC,WAAU;;;;;;kCACpB,8OAAC,oIAAA,CAAA,WAAQ;wBAAC,WAAU;;;;;;;;;;;;0BAExB,8OAAC;gBAAI,WAAU;;kCACX,8OAAC;wBAAI,WAAU;kCAAe,cAAA,8OAAC,oIAAA,CAAA,WAAQ;4BAAC,WAAU;;;;;;;;;;;kCAClD,8OAAC;wBAAI,WAAU;;0CACX,8OAAC,oIAAA,CAAA,WAAQ;gCAAC,WAAU;;;;;;0CACpB,8OAAC,oIAAA,CAAA,WAAQ;gCAAC,WAAU;;;;;;0CACpB,8OAAC,oIAAA,CAAA,WAAQ;gCAAC,WAAU;;;;;;;;;;;;kCAExB,8OAAC;wBAAI,WAAU;kCAAe,cAAA,8OAAC,oIAAA,CAAA,WAAQ;4BAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;AAIlE","debugId":null}}]
}